SELECT p.id, p.fullname, (t1.count_trans+t2.count_trans) as 'TOTAL' FROM persons p LEFT JOIN (SELECT p.id as person_id, COUNT(t.from_person_id) as 'count_trans' FROM persons p LEFT JOIN transactions t ON p.id = t.from_person_id GROUP BY t.from_person_id ) t1 ON p.id = t1.person_id LEFT JOIN (SELECT p.id as person_id, COUNT(t.to_person_id) as 'count_trans' FROM persons p LEFT JOIN transactions t ON p.id = t.to_person_id GROUP BY t.to_person_id ) t2 ON p.id = t2.person_id WHERE t1.count_trans IS NOT NULL AND t2.count_trans IS NOT NULL ORDER BY TOTAL DESC LIMIT 0,1